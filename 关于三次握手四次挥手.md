TCP的三次握手是经常被问到的问题

tcp是什么

**TCP**作为一种面向连接的，可靠的协议，它属于**传输层**的协议。只有在确认通信对端存在时才会发送数据，从而可以控制通信流量的浪费。**TCP通过检验和、序列号、确认应答、重发控制、连接管理以及窗口控制**等机制实现可靠性传输。



他和udp的区别

```
           TCP           UDP 
是否连接     面向连接     面向非连接 
传输可靠性   可靠        不可靠 
应用场合    少量数据    传输大量数据 

速度       慢         快
```





tcp的三次握手在于创建一个双向的可靠通信连接

他的可靠性是靠超时重传（确保消息有机会到达对面）来进行保证的

三次握手保证了双方都对对方的序列号进行了一个确认

为什么不进行多次握手呢，因为多次的确认毫无意义

为什么两次握手不可以呢

两次握手无法保证双发的序列号都得到了一个确认

从而会引发其他问题



因为双方都维护了一个序列号seq， 为了保证传输的可靠性，所以需要对方都序列号做一个确认所以需要三次握手

三次握手过程:







tcp连接靠两个属性值

一个是seq 序号值

一个是ack确认值





![å¨è¿éæå¥å¾çæè¿°](https://img-blog.csdnimg.cn/20191129144820655.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xlbmd4aWFvMTk5Mw==,size_16,color_FFFFFF,t_70)



三次握手” 的目的是 “为了防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误

client 发出的第一个连接请求报文段并没有丢失，而是在某个网络结点长时间的滞留了，以致延误到连接释放以后的某个时间才到达 server。本来这是一个早已失效的报文段。但 server 收到此失效的连接请求报文段后，就误认为是 client 再次发出的一个新的连接请求。于是就向 client 发出确认报文段，同意建立连接。假设不采用 “三次握手”，那么只要 server 发出确认，新的连接就建立了。由于现在 client 并没有发出建立连接的请求，因此不会理睬 server 的确认，也不会向 server 发送数据。但 server 却以为新的运输连接已经建立，并一直等待 client 发来数据。这样，server 的很多资源就白白浪费掉了。采用 “三次握手” 的办法可以防止上述现象发生。例如刚才那种情况，client 不会向 server 的确认发出确认。server 由于收不到确认，就知道 client 并没有要求建立连接。”



